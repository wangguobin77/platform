!function(t,e,n,o){jQuery(function(){t.fn.Tdrag=function(n){var o={scope:null,grid:null,axis:"all",pos:!1,handle:null,moveClass:"tezml",dragChange:!1,changeMode:"point",cbStart:function(){},cbMove:function(){},cbEnd:function(){},random:!1,randomInput:null,animation_options:{duration:800,easing:"ease-out"},disable:!1,disableInput:null},i=new e(this,n);n&&0==t.isEmptyObject(n)?i.options=t.extend(o,n):i.options=o,i.firstRandom=!0;var s=i.$element;i.pack(s,!1),null!=i.options.randomInput&&t(i.options.randomInput).bind("click",function(){i.pack(s,!0)}),i.loadJqueryfn()};var e=function(t,e){this.$element=t,this.options=e};e.prototype={init:function(e){var o=this;o.ele=o.$element,o.handle=t(e),o.options=o.options,o.disable=o.options.disable,o._start=!1,o._move=!1,o._end=!1,o.disX=0,o.disY=0,o.zIndex=1e3,o.moving=!1,o.moves="",o.box="string"===t.type(o.options.scope)?o.options.scope:null,null!=o.options.handle&&(o.handle=t(e).find(o.options.handle)),o.handle.on("mousedown",function(t){return o.start(t,e),e.setCapture&&e.setCapture(),!1}),o.options.dragChange?(t(e).on("mousemove",function(t){o.move(t,e)}),t(e).on("mouseup",function(t){o.end(t,e)})):(t(n).on("mousemove",function(t){o.move(t,e)}),t(n).on("mouseup",function(t){o.end(t,e)}))},loadJqueryfn:function(){var e=this;t.extend({sortBox:function(e){for(var n=[],o=0;o<t(e).length;o++)n.push(t(e).eq(o));for(var i=0;i<n.length;i++)for(var s=i+1;s<n.length;s++)if(Number(n[i].attr("index"))>Number(n[s].attr("index"))){var a=n[i];n[i]=n[s],n[s]=a}return n},randomfn:function(n){e.pack(t(n),!0)},disable_open:function(){e.disable=!1},disable_cloose:function(){e.disable=!0}})},toDisable:function(){var e=this;null!=e.options.disableInput&&t(e.options.disableInput).bind("click",function(){1==e.disable?e.disable=!1:e.disable=!0})},start:function(e,n){var o=this;if(o.moved=n,1==o.disable)return!1;o._start=!0;var i=e||event;o.disX=i.clientX-n.offsetLeft,o.disY=i.clientY-n.offsetTop,t(n).css("zIndex",o.zIndex++),o.options.cbStart()},move:function(t,e){var n=this;if(1!=n._start)return!1;if(e!=n.moved)return!1;n._move=!0;var o=t||event,i=o.clientX-n.disX,s=o.clientY-n.disY;if(null!=n.box){var a=n.collTestBox(e,n.box);i>a.lmax?i=a.lmax:i<a.lmin&&(i=a.lmin),s>a.tmax?s=a.tmax:s<a.tmin&&(s=a.tmin)}"all"==n.options.axis?(e.style.left=n.grid(e,i,s).left+"px",e.style.top=n.grid(e,i,s).top+"px"):"y"==n.options.axis?e.style.top=n.grid(e,i,s).top+"px":"x"==n.options.axis&&(e.style.left=n.grid(e,i,s).left+"px"),1==n.options.pos&&n.moveAddClass(e),n.options.cbMove(e,n)},end:function(e,n){var o=this;return 1==o._start&&("sort"==o.options.changeMode&&1==o.options.pos?o.sortDrag(n):"point"==o.options.changeMode&&1==o.options.pos&&o.pointDrag(n),1==o.options.pos&&o.animation(n,o.aPos[t(n).attr("index")]),o.options.cbEnd(),null!=o.options.handle?(t(n).find(o.options.handle).unbind("onmousemove"),t(n).find(o.options.handle).unbind("onmouseup")):(t(n).unbind("onmousemove"),t(n).unbind("onmouseup")),n.releaseCapture&&n.releaseCapture(),void(o._start=!1))},collTestBox:function(e,n){var o=0,i=0,s=t(n).innerWidth()-t(e).outerWidth(),a=t(n).innerHeight()-t(e).outerHeight();return{lmin:o,tmin:i,lmax:s,tmax:a}},grid:function(e,n,o){var i=this,s={left:n,top:o};if(t.isArray(i.options.grid)&&2==i.options.grid.length){var a=i.options.grid[0],r=i.options.grid[1];return s.left=Math.floor((n+a/2)/a)*a,s.top=Math.floor((o+r/2)/r)*r,s}return null==i.options.grid?s:(console.log("grid参数传递格式错误"),!1)},findNearest:function(t){for(var e=this,n=(new Date).getTime(),o=-1,i=e.ele,s=0;s<i.length;s++)if(t!=i[s]&&e.collTest(t,i[s])){var a=e.getDis(t,i[s]);a<n&&(n=a,o=s)}return o==-1?null:i[o]},getDis:function(t,e){var n=t.offsetLeft+t.offsetWidth/2,o=e.offsetLeft+e.offsetWidth/2,i=t.offsetTop+t.offsetHeight/2,s=e.offsetTop+e.offsetHeight/2,a=o-n,r=i-s;return Math.sqrt(a*a+r*r)},collTest:function(t,e){var n=t.offsetLeft,o=t.offsetLeft+t.offsetWidth,i=t.offsetTop,s=t.offsetTop+t.offsetHeight,a=e.offsetLeft,r=e.offsetLeft+e.offsetWidth,f=e.offsetTop,l=e.offsetTop+e.offsetHeight;return!(o<a||r<n||f>s||l<i)},pack:function(e,n){var o=this;if(o.toDisable(),0==o.options.pos)for(var i=0;i<e.length;i++)t(e[i]).css("position","absolute"),t(e[i]).css("margin","0"),o.init(e[i]);else if(1==o.options.pos){var s=[];if(o.options.random||n)for(;s.length<e.length;){var a=o.rnd(0,e.length);o.finInArr(s,a)||s.push(a)}if(0==o.options.random||1!=n)for(var a=0;s.length<e.length;)s.push(a),a++;if(0==o.firstRandom){for(var r=[],a=0;r.length<e.length;)r.push(a),a++;for(var i=0;i<e.length;i++)t(e[i]).attr("index",r[i]),t(e[i]).css("left",o.aPos[r[i]].left),t(e[i]).css("top",o.aPos[r[i]].top)}if(o.aPos=[],0==o.firstRandom)for(var f=0;f<e.length;f++)o.aPos[f]={left:e[t(e).eq(f).attr("index")].offsetLeft,top:e[t(e).eq(f).attr("index")].offsetTop};else for(var f=0;f<e.length;f++)o.aPos[f]={left:e[f].offsetLeft,top:e[f].offsetTop};for(var i=0;i<e.length;i++)t(e[i]).attr("index",s[i]),t(e[i]).css("left",o.aPos[s[i]].left),t(e[i]).css("top",o.aPos[s[i]].top),t(e[i]).css("position","absolute"),t(e[i]).css("margin","0"),o.init(e[i]);o.firstRandom=!1}},moveAddClass:function(e){var n=this,o=n.findNearest(e);t(n.$element).removeClass(n.options.moveClass),o&&0==t(o).hasClass(n.options.moveClass)&&t(o).addClass(n.options.moveClass)},sort:function(){for(var e=this,n=[],o=0;o<e.$element.length;o++)n.push(e.$element[o]);for(var i=0;i<n.length;i++)for(var s=i+1;s<n.length;s++)if(Number(t(n[i]).attr("index"))>Number(t(n[s]).attr("index"))){var a=n[i];n[i]=n[s],n[s]=a}return n},pointDrag:function(e){var n=this,o=n.findNearest(e);if(o){n.animation(e,n.aPos[t(o).attr("index")]),n.animation(o,n.aPos[t(e).attr("index")]);var i;i=t(e).attr("index"),t(e).attr("index",t(o).attr("index")),t(o).attr("index",i),t(o).removeClass(n.options.moveClass)}else"end"==n.options.changeWhen&&n.animation(e,n.aPos[t(e).attr("index")])},sortDrag:function(e){var n=this,o=n.sort(),i=n.findNearest(e);if(i){if(Number(t(i).attr("index"))>Number(t(e).attr("index"))){var s=Number(t(e).attr("index"));t(e).attr("index",Number(t(i).attr("index"))+1);for(var a=s;a<Number(t(i).attr("index"))+1;a++)n.animation(o[a],n.aPos[a-1]),n.animation(e,n.aPos[t(i).attr("index")]),t(o[a]).removeClass(n.options.moveClass),t(o[a]).attr("index",Number(t(o[a]).attr("index"))-1)}else if(Number(t(e).attr("index"))>Number(t(i).attr("index"))){var s=Number(t(e).attr("index"));t(e).attr("index",t(i).attr("index"));for(var a=Number(t(i).attr("index"));a<s;a++)n.animation(o[a],n.aPos[a+1]),n.animation(e,n.aPos[Number(t(e).attr("index"))]),t(o[a]).removeClass(n.options.moveClass),t(o[a]).attr("index",Number(t(o[a]).attr("index"))+1)}}else n.animation(e,n.aPos[t(e).attr("index")])},animation:function(t,e){var n=this,o=n.options.animation_options,n=this,i=Math.round(o.duration/30),s={},a={};for(var r in e){if(s[r]=parseFloat(n.getStyle(t,r)),isNaN(s[r]))switch(r){case"left":s[r]=t.offsetLeft;break;case"top":s[r]=t.offsetTop;break;case"width":s[r]=t.offsetWidth;break;case"height":s[r]=t.offsetHeight;break;case"marginLeft":s[r]=t.offsetLeft;break;case"borderWidth":s[r]=0}a[r]=e[r]-s[r]}var f=0;clearInterval(t.timer),t.timer=setInterval(function(){f++;for(var n in e){switch(o.easing){case"linear":var r=f/i,l=s[n]+a[n]*r;break;case"ease-in":var r=f/i,l=s[n]+a[n]*r*r*r;break;case"ease-out":var r=1-f/i,l=s[n]+a[n]*(1-r*r*r)}"opacity"==n?(t.style.opacity=l,t.style.filter="alpha(opacity:"+100*l+")"):t.style[n]=l+"px"}f==i&&(clearInterval(t.timer),o.complete&&o.complete())},30)},getStyle:function(t,e){return(t.currentStyle||getComputedStyle(t,!1))[e]},rnd:function(t,e){return parseInt(Math.random()*(e-t)+t)},finInArr:function(t,e){for(var n=0;n<t.length;n++)if(t[n]==e)return!0;return!1}}})}(jQuery,window,document);
//# sourceMappingURL=Tdrag.js.map
