{"version":3,"sources":["addCommodity.js"],"names":["getAlreadySetSkuVals","alreadySetSkuVals","$","each","skuPrice","this","find","val","skuStock","propvalids","attr","document","on","skuTypeArr","totalRow","skuTypeNode","children","skuTypeObj","skuTypeTitle","propid","skuTypeKey","skuValueArr","skuValNode","next","skuValCheckBoxs","checkedNodeLen","is","skuValObj","skuValueTitle","skuValueId","skuPropId","push","length","skuValues","skuValueLen","SKUTableDom","t","i","currRowDoms","rowCount","propvalidArr","propIdArr","propvalnameArr","propNameArr","j","anInterBankNum","point","parseInt","toString","productName","productUpc","currGroupSkuVal","join","html","click","before","delegate","e","preventDefault","show","hide"],"mappings":"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","file":"addCommodity.js","sourcesContent":["// 生成表格\nvar alreadySetSkuVals = {};//已经设置的SKU值数据\n\n$(function(){\n    //sku属性发生改变时,进行表格创建\n    $(document).on(\"change\",'.sku_value',function(){\n        getAlreadySetSkuVals();//获取已经设置的SKU值\n        // var b = true;\n        var skuTypeArr =  [];//存放SKU类型的数组\n        var totalRow = 1;//总行数\n        //获取元素类型\n        $(\".SKU_TYPE\").each(function(){\n            //SKU类型节点\n            var skuTypeNode = $(this).children(\"li\");\n            var skuTypeObj = {};//sku类型对象\n            //SKU属性类型标题\n            skuTypeObj.skuTypeTitle = $(skuTypeNode).attr(\"sku-type-name\");\n            //SKU属性类型主键\n            var propid = $(skuTypeNode).attr(\"propid\");\n            skuTypeObj.skuTypeKey = propid;\n            //是否是必选SKU 0：不是；1：是；\n            var is_required = $(skuTypeNode).attr(\"is_required\");\n            skuValueArr = [];//存放SKU值得数组\n            //SKU相对应的节点\n            var skuValNode = $(this).next();\n            //获取SKU值\n            var skuValCheckBoxs = $(skuValNode).find(\"input[type='checkbox'][class*='sku_value']\");\n            var checkedNodeLen = 0 ;//选中的SKU节点的个数\n            $(skuValCheckBoxs).each(function(){\n                if($(this).is(\":checked\")){\n                    var skuValObj = {};//SKU值对象\n                    skuValObj.skuValueTitle = $(this).val();//SKU值名称\n                    skuValObj.skuValueId = $(this).attr(\"propvalid\");//SKU值主键\n                    skuValObj.skuPropId = $(this).attr(\"propid\");//SKU类型主键\n                    skuValueArr.push(skuValObj);\n                    checkedNodeLen ++ ;\n                }\n            });\n            if(skuValueArr && skuValueArr.length > 0){\n                totalRow = totalRow * skuValueArr.length;\n                skuTypeObj.skuValues = skuValueArr;//sku值数组\n                skuTypeObj.skuValueLen = skuValueArr.length;//sku值长度\n                skuTypeArr.push(skuTypeObj);//保存进数组中\n            }\n        });\n        var SKUTableDom = \"\";//sku表格数据\n        //开始创建行\n            SKUTableDom += \"<table class='skuTable'><tr>\";\n            //创建表头\n            for(var t = 0 ; t < skuTypeArr.length ; t ++){\n                SKUTableDom += '<th>'+skuTypeArr[t].skuTypeTitle+'</th>';\n            }\n            SKUTableDom += '<th>关联商品名称</th><th>关联商品upc</th><th>操作</th>';\n            SKUTableDom += \"</tr>\";\n            //循环处理表体\n            for(var i = 0 ; i < totalRow ; i ++){//总共需要创建多少行\n                var currRowDoms = \"\";\n                var rowCount = 1;//记录行数\n                var propvalidArr = [];//记录SKU值主键\n                var propIdArr = [];//属性类型主键\n                var propvalnameArr = [];//记录SKU值标题\n                var propNameArr = [];//属性类型标题\n                for(var j = 0 ; j < skuTypeArr.length ; j ++){//sku列\n                    var skuValues = skuTypeArr[j].skuValues;//SKU值数组\n                    var skuValueLen = skuValues.length;//sku值长度\n                    rowCount = (rowCount * skuValueLen);//目前的生成的总行数\n                    var anInterBankNum = (totalRow / rowCount);//跨行数\n                    var point = ((i / anInterBankNum) % skuValueLen);\n                    propNameArr.push(skuTypeArr[j].skuTypeTitle);\n                    if(0  == (i % anInterBankNum)){//需要创建td\n                        currRowDoms += '<td rowspan='+anInterBankNum+'>'+skuValues[point].skuValueTitle+'</td>';\n                        propvalidArr.push(skuValues[point].skuValueId);\n                        propIdArr.push(skuValues[point].skuPropId);\n                        propvalnameArr.push(skuValues[point].skuValueTitle);\n                    }else{\n                        //当前单元格为跨行\n                        propvalidArr.push(skuValues[parseInt(point)].skuValueId);\n                        propIdArr.push(skuValues[parseInt(point)].skuPropId);\n                        propvalnameArr.push(skuValues[parseInt(point)].skuValueTitle);\n                    }\n                }\n\n                var propvalids = propvalidArr.toString()\n                var productName = \"\";//已经设置的商品名称\n                var productUpc = \"\";//已经设置的商品的UPC\n                //赋值\n                if(alreadySetSkuVals){\n                    var currGroupSkuVal = alreadySetSkuVals[propvalids];//当前这组SKU值\n                    if(currGroupSkuVal){\n                        productName = currGroupSkuVal.skuPrice;\n                        productUpc = currGroupSkuVal.skuStock\n                    }\n                }\n                //console.log(propvalids);\n                SKUTableDom += '<tr propvalids=\\''+propvalids+'\\' propids=\\''+propIdArr.toString()+'\\' propvalnames=\\''+propvalnameArr.join(\";\")+'\\'  propnames=\\''+propNameArr.join(\";\")+'\\' class=\"sku_table_tr\">'+currRowDoms+'<td>'+productName+'</td><td>'+productUpc+'</td>'+'<td class=\"xuanze cursor\">'+'<span class=\"select\">'+'选择'+'</span>'+'<span class=\"moren\">'+'默认'+'</span>'+'</td></tr>';\n            }\n            SKUTableDom += \"</table>\";\n        // }\n        $(\"#skuTable\").html(SKUTableDom);\n    });\n});\n\n/**\n * 获取已经设置的SKU值\n */\nfunction getAlreadySetSkuVals(){\n    alreadySetSkuVals = {};\n    //获取设置的SKU属性值\n    $(\"tr[class*='sku_table_tr']\").each(function(){\n        var skuPrice = $(this).find(\"input[type='text'][class*='setting_sku_price']\").val();//SKU价格\n        var skuStock = $(this).find(\"input[type='text'][class*='setting_sku_stock']\").val();//SKU库存\n        if(skuPrice || skuStock){//已经设置了全部或部分值\n            var propvalids = $(this).attr(\"propvalids\");//SKU值主键集合\n            alreadySetSkuVals[propvalids] = {\n                \"skuPrice\" : skuPrice,\n                \"skuStock\" : skuStock\n            }\n        }\n    });\n}\n/*\n添加规格参数\n */\n$('.add-ggcs').click(function(){\n    $(this).before(\n        \"<div class='row jiage-wrap'>\"+\n                \"<div class='row'>\"+\n                    \"<div class='col-md-5 row-xx gg-box'>\"+\n                        \"<h4 class='col-md-12 T1RRTittle'>\"+\"规格标题:\"+\"</h4>\"+\n                        \"<div class='input-box col-md-12 col-xs-12 input-box select-input'>\"+\n                            \"<input type='text' name='' placeholder='请输入商品名称' class='sl shuru'>\"+\n                            \"<span class='ts'>\"+\"*请输入正确的出参数\"+\"</span>\"+\n                        \"</div>\"+\n                    \"</div>\"+\n                \"</div>\"+\n                \"<div class='row jiage-wrap' style='padding-left:15px;position:relative;'>\"+\n                    \"<div class='col-md-5 row-xx gg-box' style='padding-left:0;'>\"+\n                        \"<h4 class='col-md-12 T1RRTittle'>\"+\"规格名称：\"+\"</h4>\"+\n                        \"<div class='input-box col-md-12 col-xs-12 input-box select-input'>\"+\n                            \"<input type='text' name='' placeholder='请输入商品名称' class='sl shuru'>\"+\n                            \"<span class='ts'>\"+\"*请输入正确的出参数\"+\"</span>\"+\n                        \"</div>\"+\n                    \"</div>\"+\n                    \"<div class='col-md-5 row-xx gg-box' style='padding-right:0;'>\"+\n                        \"<h4 class='col-md-12 col-xs-12 T1RRTittle'>\"+\"规格内容：\"+\"</h4>\"+\n                        \"<div class='input-box col-md-12 col-xs-12 input-box select-input'>\"+\n                            \"<input type='text' name='' placeholder='请输入商品名称' class='sl shuru'>\"+\n                            \"<span class='ts'>\"+\"*请输入正确的出参数\"+\"</span>\"+\n                        \"</div>\"+\n                    \"</div>\"+\n                    \"<span class='font_family icon-operation_delate col-md-1 cursor' style='font-size:24px;margin-top:45px;'>\"+\n                    \"</span>\"+\n                \"</div>\"+\n\n                \"<div class='col-md-6 row-xx add-mc' style='padding-left:0;'>\"+\n                    \"<h4 class='col-md-12 col-xs-12 T1RRTittle glyphicon glyphicon-plus cursor'>\"+\"添加名称及内容\"+\"</h4>\"+\n                \"</div>\"+\n                \"<hr class='col-md-10'>\"+\n            \"</div>\"\n\n    )\n\n})\n/*\n    添加规格名称及内容\n */\n$('.content-wrap').delegate('.add-mc','click',function(e){\n    e.preventDefault();\n    $(this).before(\n         \"<div class='row jiage-wrap' style='padding-left:15px;position:relative;'>\"+\n            \"<div class='col-md-5 row-xx gg-box' style='padding-left:0;'>\"+\n                \"<h4 class='col-md-12 T1RRTittle'>\"+\"规格名称：\"+\"</h4>\"+\n                \"<div class='input-box col-md-12 col-xs-12 input-box select-input'>\"+\n                    \"<input type='text' name='' placeholder='请输入商品名称' class='sl shuru'>\"+\n                    \"<span class='ts'>\"+\"*请输入正确的出参数\"+\"</span>\"+\n                \"</div>\"+\n            \"</div>\"+\n            \"<div class='col-md-5 row-xx gg-box' style='padding-right:0;'>\"+\n                \"<h4 class='col-md-12 col-xs-12 T1RRTittle'>\"+\"规格内容：\"+\"</h4>\"+\n                \"<div class='input-box col-md-12 col-xs-12 input-box select-input'>\"+\n                    \"<input type='text' name='' placeholder='请输入商品名称' class='sl shuru'>\"+\n                    \"<span class='ts'>\"+\"*请输入正确的出参数\"+\"</span>\"+\n                \"</div>\"+\n            \"</div>\"+\n            \"<span class='font_family icon-operation_delate col-md-1 cursor' style='font-size:24px;margin-top:45px;'>\"+\n            \"</span>\"+\n        \"</div>\"\n\n    )\n\n})\n\n// 点击选择  出现选择的关联商品\n$('.sc-box').delegate('td.xuanze', 'click', function(e) {\n    e.preventDefault();\n    $('.del-box').show();\n});\n\n// 点击弹框关闭按钮\n$('.btn-close').click(function(){\n    $('.del-box').hide();\n\n})\n\n"]}